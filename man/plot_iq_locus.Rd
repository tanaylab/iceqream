% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/iq-plot.R
\name{plot_iq_locus}
\alias{plot_iq_locus}
\title{Plot IQ Locus}
\usage{
plot_iq_locus(
  interval,
  pbm_list,
  atac_tracks,
  width = 500,
  ext_width = 200000,
  T_emax = 8,
  T_rmax = NULL,
  motifs = NULL,
  plot_others = FALSE,
  trim_pbms = TRUE,
  trim_bits_thresh = 0.1,
  bits_threshold = NULL,
  order_motifs = TRUE,
  atac_names = atac_tracks,
  atac_colors = NULL,
  atac_sizes = NULL,
  line_thresh = 0.9,
  title = NULL,
  subtitle = NULL,
  score = NULL,
  predicted_score = NULL,
  dna = NULL,
  norm_q = 0.995,
  tracks_q = NULL,
  iterator = 20,
  norm_intervals = gintervals.all(),
  atac_smooth = 2,
  ext_atac_smooth = atac_smooth * 5,
  tn5bias_track = "tn5bias",
  normalize_tn5bias = TRUE,
  tss_intervals = "intervs.global.tss",
  exon_intervals = "intervs.global.exon",
  annot_track = NULL,
  annot_track_name = NULL,
  annot_colors = c("#FF9800", "#009688"),
  annot_track_iterator = 1,
  annot_track_smooth = 1,
  annot_intervals = NULL,
  annot_intervals_color = "darkgreen",
  mark_conservation = FALSE,
  conservation_threshold = 1.5,
  scale_cex = 500,
  dna_height = 0.03,
  filename = NULL,
  dev = grDevices::pdf,
  plot_width = 15,
  plot_height = 8,
  base_size = 8,
  base_family = "ArialMT",
  rasterize = FALSE,
  raster_device = "ragg",
  ...
)
}
\arguments{
\item{interval}{A genomic interval to plot.}

\item{pbm_list}{A list of PBM objects.}

\item{atac_tracks}{A vector of ATAC-seq track names to plot.}

\item{width}{Width of the plot in bp.}

\item{ext_width}{Width of the top plot in bp.}

\item{T_emax}{Numeric, threshold for maximum energy.}

\item{T_rmax}{Numeric, threshold for maximum response.}

\item{motifs}{A list of specific motifs to plot.}

\item{plot_others}{Logical, whether to plot other motifs that pass the threshold when specific motifs are provided.}

\item{trim_pbms}{Logical, whether to trim PBM objects by removing positions with low information content from the beginning and end of the PSSM.}

\item{trim_bits_thresh}{Numeric, threshold for trimming PBM objects.}

\item{bits_threshold}{Numeric, threshold for trimming PSSMs.}

\item{order_motifs}{Logical, whether to order motifs by maximum response.}

\item{atac_names}{Character vector, names for ATAC-seq tracks.}

\item{atac_colors}{Named vector, colors for ATAC-seq tracks.}

\item{atac_sizes}{Named vector, line sizes for ATAC-seq tracks.}

\item{line_thresh}{Numeric, threshold for drawing vertical lines.}

\item{title}{Character, optional title for the plot.}

\item{subtitle}{Character, optional subtitle for the plot.}

\item{score}{Numeric, optional score to display in the plot title.}

\item{predicted_score}{Numeric, optional predicted score to display in the plot title.}

\item{dna}{Character, DNA sequence to plot. If NULL, the sequence is extracted from the interval.}

\item{norm_q}{Numeric, quantile for normalization. If a vector, should have the same length as atac_names.}

\item{tracks_q}{Data frame, pre-computed quantiles for tracks. Should have a 'type' column and a 'q' column.}

\item{iterator}{Numeric, iterator for gextract.}

\item{norm_intervals}{Genomic intervals for normalization.}

\item{atac_smooth}{Numeric, smoothing factor for ATAC-seq tracks.}

\item{ext_atac_smooth}{Numeric, smoothing factor for the top plot.}

\item{tn5bias_track}{Character, name of the Tn5 bias track.}

\item{normalize_tn5bias}{Logical, whether to normalize using the TN5 bias track. If a vector, should have the same length as atac_names.}

\item{tss_intervals}{Character, name of the TSS intervals track.}

\item{exon_intervals}{Character, name of the exon intervals track.}

\item{annot_track}{Character, name of the annotation track.}

\item{annot_track_name}{Character, display name for the annotation track.}

\item{annot_colors}{Named vector, colors for annotation track.}

\item{annot_track_iterator}{Numeric, iterator for annotation track extraction.}

\item{annot_track_smooth}{Numeric, smoothing factor for annotation track.}

\item{annot_intervals}{Genomic intervals for annotation (start positions would be used).}

\item{annot_intervals_color}{Color for annotation intervals.}

\item{mark_conservation}{Logical, whether to mark conservation in the DNA sequence.}

\item{conservation_threshold}{Numeric, threshold for marking conservation.}

\item{scale_cex}{Numeric, scaling factor for letter sizes.}

\item{dna_height}{Numeric, height of each row of DNA sequence relative to the entire plot.}

\item{filename}{Character, output filename (if NULL, plot is not saved).}

\item{dev}{Function, device to use for plotting.}

\item{plot_width}{Numeric, width of the output plot.}

\item{plot_height}{Numeric, height of the output plot.}

\item{base_size}{Numeric, base font size for the plot.}

\item{base_family}{Character, base font family for the plot.}

\item{rasterize}{Logical, whether to rasterize certain plot elements for better performance.}

\item{raster_device}{Character, device to use for rasterization.}

\item{...}{additional arguments to pass to the plotting function.}
}
\value{
A ggplot object containing the IQ locus plot.
}
\description{
This function generates a plot of an IQ locus, including DNA sequence, motif responses, and ATAC-seq tracks.
}
