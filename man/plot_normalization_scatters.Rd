% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/preprocess.R
\name{plot_normalization_scatters}
\alias{plot_normalization_scatters}
\title{Generate and save normalization visualization plots}
\usage{
plot_normalization_scatters(obj, anchor_cell_type, figures_dir)
}
\arguments{
\item{obj}{List. A preprocessed ATAC-seq data object, output from \code{\link{preprocess_data}}}

\item{anchor_cell_type}{Character. The reference cell type to use for comparisons}

\item{figures_dir}{Character or NULL. Directory path where plots should be saved.
If NULL, plots are not saved to disk. Directory will be created if it doesn't exist.}
}
\value{
None (called for side effects)
}
\description{
Creates a series of scatter plots showing the progression of ATAC-seq signal normalization
steps, comparing each cell type against an anchor cell type. The plots are automatically
saved to the specified directory if provided.
}
\details{
The function generates four visualization plots showing the progression of normalization:
\enumerate{
\item Raw signal comparison ("1_cell_type_scatter_before_norm.png")
\itemize{
\item Log2-transformed raw signals after basic library size normalization
}
\item Regional normalization ("2_cell_type_scatter_region_norm.png")
\itemize{
\item Shows effects of local background correction
}
\item Constitutive peak normalization ("3_cell_type_scatter_const_norm.png")
\itemize{
\item Displays signals after normalizing using constitutive peaks
\item Includes probability threshold line if specified
}
\item Probability normalization ("4_cell_type_scatter_prob.png")
\itemize{
\item Shows final probability-scaled signals
}
}

Each plot compares all cell types against the anchor cell type, with points
colored to distinguish constitutive from variable peaks.
}
\note{
File names are automatically generated using a numerical prefix to maintain
proper ordering when viewing in a file explorer.
}
\examples{
\dontrun{
# Generate and save plots
plot_normalization_scatters(
    atac_obj,
    anchor_cell_type = "CD4_T",
    figures_dir = "analysis/normalization_plots"
)

# Generate plots without saving
plot_normalization_scatters(
    atac_obj,
    anchor_cell_type = "CD4_T",
    figures_dir = NULL
)
}

}
\seealso{
\code{plot_cell_type_scatter} for the underlying plotting function,
\code{\link{normalize_regional}}, \code{\link{normalize_const}},
\code{\link{normalize_to_prob}} for the normalization methods being visualized
}
